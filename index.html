<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>创作实践成果展 - 2025年度艺术人才培训资助项目</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;600;900&display=swap');

        :root {
            --color-red: #ff3e3e;
            --color-blue: #3e4dff;
        }

        html, body { 
            margin: 0; padding: 0;
            background: #000; 
            font-family: 'Inter', "Source Han Sans CN", "Microsoft YaHei", sans-serif; 
            color: #fff;
            width: 100vw; height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            position: fixed;
        }
        
        #bg-canvas { position: fixed; inset: 0; z-index: -1; pointer-events: none; }

        .shooting-bar {
            position: fixed;
            border-radius: 4px;
            z-index: 10;
            pointer-events: none;
            will-change: transform;
            filter: blur(1px);
        }

        #intro, #preface {
            position: fixed; inset: 0; background: transparent; z-index: 1000;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.8s ease;
        }

        .overlay-mask {
            position: fixed; inset: 0;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.6) 100%);
            z-index: 5;
            pointer-events: none;
        }

        #preface { 
            background: rgba(0,0,0,0.95); 
            backdrop-filter: blur(30px); 
            opacity: 0; 
            pointer-events: none; 
            z-index: 1100; 
        }
        #preface.active { opacity: 1; pointer-events: auto; }

        .preface-content {
            max-height: 80vh;
            overflow-y: auto;
            padding-right: 20px;
        }
        .preface-content::-webkit-scrollbar { width: 4px; }
        .preface-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }

        .main-title {
            font-weight: 900;
            line-height: 1.4;
            background: linear-gradient(to bottom, #fff 80%, rgba(255,255,255,0.2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
            white-space: nowrap;
        }

        .exhibition-wall {
            position: relative; z-index: 20; height: 100vh;
            display: flex; flex-direction: column; justify-content: center;
            gap: 15px; opacity: 0; transition: opacity 1.5s ease;
        }

        .track-container { width: 100%; overflow: hidden; display: flex; }
        .marquee { display: flex; gap: 15px; padding: 10px 40px; animation: scroll 120s linear infinite; }
        .marquee-reverse { animation: scroll-reverse 120s linear infinite; }
        @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-50%); } }
        @keyframes scroll-reverse { from { transform: translateX(-50%); } to { transform: translateX(0); } }

        .work-card {
            width: 160px; aspect-ratio: 9/16; background: #111; 
            overflow: hidden; border-radius: 12px;
            flex-shrink: 0; cursor: pointer; border: 1px solid rgba(255,255,255,0.08);
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @media (min-width: 768px) {
            .work-card { width: 220px; border-radius: 16px; }
            .exhibition-wall { gap: 25px; }
            .marquee { gap: 20px; }
        }

        .work-card img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            object-position: top; 
            pointer-events: none; 
        }
        .work-card:hover { transform: translateY(-10px); border-color: var(--color-red); z-index: 10; box-shadow: 0 10px 30px rgba(255,62,62,0.2); }

        #detailPanel {
            position: fixed; inset: 0; z-index: 2000; display: flex;
            opacity: 0; pointer-events: none; transition: 0.4s ease;
            background: #000;
        }
        #detailPanel.active { opacity: 1; pointer-events: auto; }

        .pan-viewport {
            flex: 1; position: relative; overflow: hidden; cursor: grab;
            touch-action: none; 
            display: flex; align-items: center; justify-content: center;
            background: #080808;
        }
        .pan-viewport:active { cursor: grabbing; }

        #renderCanvas { width: 100%; height: 100%; display: block; touch-action: none; }

        .info-panel {
            width: 400px; padding: 40px; display: flex; flex-direction: column;
            justify-content: space-between; border-left: 1px solid rgba(255,255,255,0.1);
            background: rgba(15,15,15,0.98);
            z-index: 10;
        }

        .btn-action {
            background: linear-gradient(45deg, var(--color-red), var(--color-blue));
            color: #fff; padding: 14px 28px; font-size: 12px; font-weight: 700;
            letter-spacing: 0.1em; transition: 0.3s; border: none; cursor: pointer;
        }
        
        @media (max-width: 768px) {
            #detailPanel { flex-direction: column; }
            .pan-viewport { 
                flex: none; 
                height: 65vh; 
            }
            .info-panel { 
                width: 100%; flex: 1;
                border-left: none; border-top: 1px solid rgba(255,255,255,0.1); 
                padding: 20px; overflow-y: auto;
            }
            .main-title { font-size: 4.5vw; } 
        }

        .interaction-hint {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.5); padding: 6px 15px; border-radius: 20px;
            font-size: 10px; color: rgba(255,255,255,0.6); pointer-events: none;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>

    <div class="overlay-mask"></div>
    <div id="shooting-container"></div>
    <canvas id="bg-canvas"></canvas>

    <!-- 入口页 -->
    <div id="intro">
        <div class="text-center px-4 relative z-10">
            <p class="mb-3 tracking-[0.2em] text-red-500 font-bold text-[10px] md:text-xs">2025年度艺术人才培训资助项目</p>
            <h1 class="main-title text-lg md:text-3xl lg:text-4xl mb-10 uppercase">
                《基层戏曲院团舞美业务骨干人才培训》<br>创作实践成果展
            </h1>
            <button onclick="showPreface()" class="btn-action rounded-full px-10">进入展厅</button>
        </div>
    </div>

    <!-- 前言 (恢复至详细版本) -->
    <div id="preface">
        <div class="max-w-3xl w-[90%] text-white/80 leading-relaxed font-light">
            <h2 class="text-xl md:text-2xl font-black mb-6 md:mb-8 text-blue-400 border-b border-blue-400/30 pb-4 tracking-widest">PREFACE / 前言</h2>
            <div class="preface-content text-[13px] md:text-base space-y-6">
                <p style="text-indent: 2em;">由国家艺术基金资助，上海戏剧学院组织实施的2025年度艺术人才培训资助项目《基层戏曲院团舞美业务骨干人才培训》，自2025年7月15日正式启动招生，8月30日截止报名。根据国家艺术基金管理办法，项目组组织专家对有效报名资料进行评审，并报国家艺术基金管理中心批准，最终录取了来自全国16个省、直辖市、自治区，涵盖二十多个剧种收的30名学员，于10月13日举办了隆重的开班仪式。</p>
                <p style="text-indent: 2em;">该培训项目通过系统化培训，显著提升了基层戏曲院团舞美骨干人才的专业能力与综合素质，为文化传承创新提供了核心动力。其意义和效能主要体现在以下三方面：</p>
                <p><strong>一是赋能个人才干，构建复合型能力体系。</strong>项目通过理论教学与实践训练相结合，帮助学员掌握前沿创作理念与专业技能。前30天邀请42位专家集中授课，240课时内容横跨13个专业方向，既夯实了专业基础，也提升了跨领域协作能力，为个人职业发展奠定坚实基础。</p>
                <p><strong>二是推动行业更新，激活舞台艺术创新生态。</strong>结合“戏曲通识与传承创新”“数字化演艺器材操作技能”等系列课程模块，组织参观了8家领先的演艺设备企业和特色演出场所，观摩的10部不同演出样式的精品剧目，广泛学习舞美创作方法，深入了解行业发展趋势，全面提升传统戏曲的当代转化能力。</p>
                <p><strong>三是服务国家战略，开拓文旅融合发展新局面。</strong>项目始终围绕国家文化战略展开，培训工作的后30天，学员们回到各自的工作岗位，用课堂授课学习所得，完成舞台实践课程，项目组组织专家进行线上答疑指导，截止到12月12日，每位学员均完成了不少于3000字的论文1篇，全班提交创作作品超过120部，以丰富多彩的舞台呈现形式，最终为此次培训画上了圆圆的句号。</p>
                <p style="text-indent: 2em;" class="text-blue-300 italic font-normal">聚是一团火，散是满天星，希望各位学员带着培训所学的丰硕成果，迎接基层舞美工作的机遇与挑战，深入领会创造性转化和创新性发展的要旨，为创新实践激活传统戏曲文化生命力做出应有的贡献。</p>
            </div>
            <div class="mt-8 md:mt-10">
                <button onclick="enterGallery()" class="btn-action rounded-md px-12">开启观展</button>
            </div>
        </div>
    </div>

    <!-- 展厅墙 -->
    <div id="exhibition" class="exhibition-wall">
        <div class="track-container"><div id="track1" class="marquee"></div></div>
        <div class="track-container"><div id="track2" class="marquee marquee-reverse"></div></div>
    </div>

    <!-- 详情页 -->
    <div id="detailPanel">
        <div class="pan-viewport" id="panArea">
            <canvas id="renderCanvas"></canvas>
            <div class="interaction-hint">双指缩放 · 拖拽平移 · 滚轮缩放</div>
        </div>
        <div class="info-panel">
            <div class="overflow-y-auto pr-2 mb-6">
                <div class="text-blue-500 text-[10px] tracking-[0.2em] font-bold mb-2 uppercase">Works <span id="d-id">01</span></div>
                <h2 id="d-title" class="text-2xl md:text-4xl font-black mb-4">作品名称</h2>
                <div class="w-12 h-1 bg-red-500 mb-6"></div>
                <p id="d-desc" class="text-[14px] text-white/50 leading-relaxed font-light"></p>
            </div>
            <button class="btn-action w-full rounded-lg py-4" onclick="closeDetail()">返回展厅</button>
        </div>
    </div>

    <script>
        const works = [
            { title: "王亚琦", url: "https://i.ibb.co/gL7nbm3v/01.jpg" },
            { title: "汪丽丽", url: "https://i.ibb.co/N2Mh8wh8/02.jpg" },
            { title: "徐杰", url: "https://i.ibb.co/BVqhK2LR/03.jpg" },
            { title: "苏嘉莉", url: "https://i.ibb.co/TBV4xV7L/04.jpg" },
            { title: "许太新", url: "https://i.ibb.co/4g9xxTdg/05.jpg" },
            { title: "瞿一航", url: "https://i.ibb.co/ksGMc0qM/06.jpg" },
            { title: "魏涛", url: "https://i.ibb.co/PGTpxZbt/07.jpg" },
            { title: "牛慕", url: "https://i.ibb.co/zHQZ5MHV/08.jpg" },
            { title: "杨元利", url: "https://i.ibb.co/ks1bYfwS/09.jpg" },
            { title: "刘亚伟", url: "https://i.ibb.co/jPNDbd7K/10.jpg" },
            { title: "李盟", url: "https://i.ibb.co/Z69sDynv/11.jpg" },
            { title: "杨顺", url: "https://i.ibb.co/ksbFshd1/12.jpg" },
            { title: "曹天慧", url: "https://i.ibb.co/n8DKvSWf/13.jpg" },
            { title: "倪湧帆", url: "https://i.ibb.co/gFTCMvrP/14.jpg" },
            { title: "王忠阳", url: "https://i.ibb.co/nsP6xLWd/15.jpg" },
            { title: "曹德芳", url: "https://i.ibb.co/QjCKqw57/16.jpg" },
            { title: "林耀恒", url: "https://i.ibb.co/cX807bK6/17.jpg" },
            { title: "许青", url: "https://i.ibb.co/TMzNvybX/18.jpg" },
            { title: "徐帅", url: "https://i.ibb.co/gkzz5xw/19.jpg" },
            { title: "邵政伟", url: "https://i.ibb.co/TMKmv3xp/20.jpg" },
            { title: "王洁", url: "https://i.ibb.co/1f7YVRj3/21.jpg" },
            { title: "何杰", url: "https://i.ibb.co/6JfC1XfP/22.jpg" },
            { title: "董鹏飞", url: "https://i.ibb.co/Kx355Xk7/23.jpg" },
            { title: "王建磊", url: "https://i.ibb.co/PvXT2xpm/24.jpg" },
            { title: "杨学亮", url: "https://i.ibb.co/KpN4m8k8/26.jpg" },
            { title: "孙磊", url: "https://i.ibb.co/ZzzVCNFb/27.jpg" },
            { title: "钟婉靖", url: "https://i.ibb.co/9mBm4KZZ/28.jpg" },
            { title: "张大卫", url: "https://i.ibb.co/XxBgq3Yc/29.jpg" },
            { title: "朱万强", url: "https://i.ibb.co/yBq1tT8t/30.jpg" }
        ].map(w => ({...w, desc: "2025年度艺术人才培训资助项目——《基层戏曲院团舞美业务骨干人才培训》创作实践成果展作品。"}));

        let isGalleryActive = false;
        let state = { scale: 1, x: 0, y: 0, isDragging: false, currentImg: null };
        const d_canvas = document.getElementById('renderCanvas');
        const d_ctx = d_canvas.getContext('2d');
        const panArea = document.getElementById('panArea');

        // 彩带效果恢复 (上一个版本的参数设置)
        function createShootingBar() {
            const container = document.getElementById('shooting-container');
            const bar = document.createElement('div');
            bar.className = 'shooting-bar';
            const color = Math.random() > 0.4 ? 'var(--color-red)' : 'var(--color-blue)';
            const startY = Math.random() * 100;
            const duration = 1500 + Math.random() * 2500;
            const width = 300 + Math.random() * 500;
            // 恢复透明度和粗细逻辑
            const opacity = isGalleryActive ? (0.2 + Math.random() * 0.4) : (0.03 + Math.random() * 0.07);
            bar.style.height = (4 + Math.random() * 3) + 'px';
            bar.style.width = width + 'px';
            bar.style.top = startY + 'vh';
            bar.style.background = `linear-gradient(90deg, transparent, ${color}, transparent)`;
            bar.style.opacity = opacity;
            container.appendChild(bar);
            bar.animate([
                { transform: `translateX(-${width}px)` },
                { transform: `translateX(${window.innerWidth + width}px)` }
            ], { duration, easing: 'linear' }).onfinish = () => bar.remove();
        }
        
        function spawnLoop() {
            createShootingBar();
            setTimeout(spawnLoop, isGalleryActive ? 200 : 800);
        }
        spawnLoop();

        function updateCanvasSize() {
            const dpr = window.devicePixelRatio || 1;
            d_canvas.width = panArea.clientWidth * dpr;
            d_canvas.height = panArea.clientHeight * dpr;
            draw();
        }

        function draw() {
            if (!state.currentImg) return;
            const dpr = window.devicePixelRatio || 1;
            const w = panArea.clientWidth, h = panArea.clientHeight;
            d_ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
            d_ctx.clearRect(0, 0, w, h);

            const img = state.currentImg;
            const imgRatio = img.width / img.height;
            const viewRatio = w / h;
            let dw, dh;
            if (imgRatio > viewRatio) { dw = w * 0.85; dh = dw / imgRatio; }
            else { dh = h * 0.7; dw = dh * imgRatio; }

            d_ctx.save();
            d_ctx.translate(w/2 + state.x, h/2 + state.y);
            d_ctx.scale(state.scale, state.scale);
            d_ctx.shadowColor = 'rgba(0,0,0,0.5)';
            d_ctx.shadowBlur = 30;
            d_ctx.drawImage(img, -dw/2, -dh/2, dw, dh);
            d_ctx.restore();
        }

        function openDetail(w, i) {
            const img = new Image();
            img.crossOrigin = "anonymous";
            img.onload = () => {
                state.currentImg = img;
                state.scale = 1; state.x = 0; state.y = 0;
                document.getElementById('d-title').innerText = w.title;
                document.getElementById('d-desc').innerText = w.desc;
                document.getElementById('d-id').innerText = String(i+1).padStart(2,'0');
                document.getElementById('detailPanel').classList.add('active');
                setTimeout(updateCanvasSize, 50);
            };
            img.src = w.url;
        }

        function closeDetail() { document.getElementById('detailPanel').classList.remove('active'); }

        let lastX = 0, lastY = 0, initialPinchDist = 0;
        let evCache = [];

        panArea.addEventListener('pointerdown', e => {
            evCache.push(e);
            if (evCache.length === 1) {
                state.isDragging = true;
                lastX = e.clientX; lastY = e.clientY;
            } else if (evCache.length === 2) {
                initialPinchDist = Math.hypot(evCache[0].clientX - evCache[1].clientX, evCache[0].clientY - evCache[1].clientY);
            }
            panArea.setPointerCapture(e.pointerId);
        });

        panArea.addEventListener('pointermove', e => {
            const index = evCache.findIndex(ev => ev.pointerId === e.pointerId);
            if (index > -1) evCache[index] = e;

            if (evCache.length === 1 && state.isDragging) {
                state.x += (e.clientX - lastX);
                state.y += (e.clientY - lastY);
                lastX = e.clientX; lastY = e.clientY;
                draw();
            } else if (evCache.length === 2) {
                const dist = Math.hypot(evCache[0].clientX - evCache[1].clientX, evCache[0].clientY - evCache[1].clientY);
                const zoomFactor = dist / initialPinchDist;
                state.scale = Math.min(Math.max(0.5, state.scale * (1 + (zoomFactor - 1) * 0.1)), 5);
                initialPinchDist = dist;
                draw();
            }
        });

        const endPointer = e => {
            const index = evCache.findIndex(ev => ev.pointerId === e.pointerId);
            if (index > -1) evCache.splice(index, 1);
            if (evCache.length < 2) initialPinchDist = 0;
            if (evCache.length === 0) state.isDragging = false;
        };
        panArea.addEventListener('pointerup', endPointer);
        panArea.addEventListener('pointercancel', endPointer);

        panArea.addEventListener('wheel', e => {
            e.preventDefault();
            const factor = e.deltaY > 0 ? 0.9 : 1.1;
            state.scale = Math.min(Math.max(0.3, state.scale * factor), 8);
            draw();
        }, { passive: false });

        function initGallery() {
            const t1 = document.getElementById('track1'), t2 = document.getElementById('track2');
            works.forEach((w, i) => {
                const card = document.createElement('div');
                card.className = 'work-card';
                card.innerHTML = `<img src="${w.url}" loading="lazy" crossorigin="anonymous">`;
                card.onclick = () => openDetail(w, i);
                if (i % 2 === 0) t1.appendChild(card); else t2.appendChild(card);
            });
            [t1, t2].forEach(track => {
                const clones = Array.from(track.children).map(node => {
                    const clone = node.cloneNode(true);
                    clone.onclick = node.onclick;
                    return clone;
                });
                clones.forEach(c => track.appendChild(c));
            });
        }

        function showPreface() {
            document.getElementById('intro').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('intro').style.display = 'none';
                document.getElementById('preface').classList.add('active');
            }, 600);
        }

        function enterGallery() {
            isGalleryActive = true;
            document.getElementById('preface').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('preface').style.display = 'none';
                document.getElementById('exhibition').style.opacity = '1';
                initStars();
            }, 600);
        }

        function initStars() {
            const bg = document.getElementById('bg-canvas'), ctx = bg.getContext('2d');
            let w, h;
            const resize = () => { w = bg.width = window.innerWidth; h = bg.height = window.innerHeight; };
            window.addEventListener('resize', () => { resize(); updateCanvasSize(); }); 
            resize();
            function loop() {
                ctx.fillStyle = 'rgba(0,0,0,0.15)';
                ctx.fillRect(0, 0, w, h);
                requestAnimationFrame(loop);
            }
            loop();
        }

        window.onload = initGallery;
    </script>
</body>
</html>
